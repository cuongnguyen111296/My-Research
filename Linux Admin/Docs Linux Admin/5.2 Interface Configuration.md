# Interface Configuration

- Tài liệu này sẽ giải thích cách cấu hình `network interface cards` để hoạt động với `tcp/ip`.

### GUI or not GUI

- Các bản phân phối Linux thường bao gồm một giao diện đồ họa để cấu hình mạng. Nhưng nhiều người dùng đã báo cáo cấu hình bằng cách này làm rối cấu hình mạng khi được sử dụng đồng thời với cấu hình dòng lệnh. 
- Vì mục tiêu của chuỗi tài liệu này là `server administration`, nên ta sẽ giả định các Linux server luôn được quản lý thông qua `command line`.
- Tài liệu này sẽ tập chung vào việc sử dụng command line để cấu hình network interface.
- Do không có sự đồng nhất nào trong `Linux command` và `/etc file` trên tất cả các bản phân phối Linux. Nên chúng ta sẽ thảo luận về cấu hình mạng trên 2 dòng phân phối lớn.
- Ta sẽ bắt đầu với `Debian` (tương tự trên `Ubuntu` và `Mint`), sau đó tiếp tục với `RHEL`(tương tự `CentOS` và `Fedora`).

## Debian NIC Configuration

- Lưu ý trên các bản phân phối Ubuntu 18 trở lên, netplan là tool config network mặc định. Trong tài liệu này ta sẽ tìm hiểu về cách config bằng `ifupdown`. Có thể tham khảo bài viết [Hướng dẫn xóa netplan và cài đặt ifupdown thay thế trên Ubuntu](https://news.cloud365.vn/huong-dan-xoa-netplan-va-cai-dat-ifupdown-thay-the-tren-ubuntu-18-04/) để xóa netplan và cấu hình ifupdown.

### /etc/network/interfaces

- File `/etc/network/interfaces` là một file cấu hình core network interface card trên Debian.

#### dhcp client

- Bên dưới cho thấy cấu hình `dhcp` trên card mạng `ens33` :
    ```
    root@ubuntu22-lab:~# cat /etc/network/interfaces
    # interfaces(5) file used by ifup(8) and ifdown(8)
    # Include files from /etc/network/interfaces.d:
    source /etc/network/interfaces.d/*

    auto lo
    iface lo inet loopback

    auto ens33
    iface ens33 inet dhcp
    ```

- Cấu hình network card dạng `dhcp` rất tốt và thuận tiện cho máy client, nhưng với server thì thường yêu cầu các địa chỉ IP cố định.

#### fixed ip

- Bên dưới là cấu hình file `/etc/network/interfaces` với một địa chỉ IP cố định :
    ```
    root@ubuntu22-lab:~# cat /etc/network/interfaces
    auto lo
    iface lo inet loopback

    auto ens33
    iface ens33 inet static
    address 10.88.88.154
    netmask 255.255.255.0
    network 10.88.88.0
    gateway 10.88.88.2
    ```

### /sbin/ifdown

- Thông thường chúng ta nên down card mạng trước khi thay đổi cấu hình của nó. Điều này có thể được thực hiện bằng lệnh `ifdown`.
- Với interface được cấu hình với ip cố định, lệnh này sẽ không có output nào ra màn hình. Sau khi down interface thì lệnh ifconfig sẽ không nhìn thấy interface này.

### /sbin/ifup

- Tương tự như ifdown, lệnh `ifup` cũng sẽ up interface mà không hiển thị output gì ra màn hình với ip cố định.
- Nếu interface sử dụng `dhcp` thì sẽ có output tương tự như dưới đây :
    
    ![a](https://imgur.com/nrcLGvL.png)

## RHEL nic configuration

### /etc/sysconfig/network

- File `/etc/sysconfig/network` là file cấu hình chung (trên tất cả các card mạng). Nó cho phép chúng ta có muốn kết nối mạng hay không (NETWORKING=yes/no), tên (HOSTNAME=), (GATEWAY=).

    ![a]()